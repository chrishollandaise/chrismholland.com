---
import BaseLayout from "../layouts/BaseLayout.astro";
import ContactMe from "../components/ContactMe.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import Avatar from "../assets/me.png";
import ArticleTable from "../components/ArticleTable.astro";
import SocialStack from "../components/SocialStack.astro";

const latestArticles = await getCollection("blog", ({ data }) => {
	return !data.tags.includes("project");
});

latestArticles.sort((a, b) => {
	return b.data.pubDate.getTime() - a.data.pubDate.getTime();
});

const projects = await getCollection("blog", ({ data }) => {
	return data.tags.includes("project");
});

projects.sort((a, b) => {
	return a.data.title > b.data.title ? 1 : -1;
});
---

<BaseLayout>
	<h1>Chris Holland</h1>
	<section>
		<h2>Software Engineer - Seattle, WA</h2>
		<div class="article" style="display: flex; align-items: center;">
			<Image
				src={Avatar}
				alt="Pixelated avatar of me"
				width="128"
				format="avif"
				quality={50}
			/>
			<div>
				<p>
					I am a lifelong learner who loves coaxing computers into
					solving real-world headaches. I live for crafting simple yet
					impactful tech.
				</p>
				<p>
					On the side, I learn new languages, write, and try to touch
					some grass.
				</p>
				<p style="font-weight:bold;">Follow me on:</p>
				<SocialStack />
			</div>
		</div>
	</section>
	<section>
		<h2>Latest Posts</h2>
		<ArticleTable articles={latestArticles.splice(0, 5)} />
	</section>
	<section>
		<h2>Noteworthy Projects</h2>
		<ArticleTable
			articles={projects}
			head={["Date", "Project", "Technologies"]}
			includeProjectTag={false}
		/>
	</section>
	<section>
		<h2>Quick Links</h2>
		<ul>
			<li><a href="/">dot config</a></li>
			<li><a href="/">vim bindings</a></li>
		</ul>
	</section>
	<ContactMe />
</BaseLayout>
